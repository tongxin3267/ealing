{extend name="admin/public/base"/}

{block name="style"}
<style>
	.list-header{
		background-color: #ffffff;
		padding-bottom: 24px;
	}
	.list-content{
		padding: 24px 24px 14px 24px;
	}
</style>
{/block}

{block name="content"}
<Layout>
	<Header class="list-header">
		<i-button v-for="button in buttonList" :class="button.attr.class" :icon="button.attr.icon">{{ button.title }}</i-button>
		<Modal v-model="modalEnable" class-name="vertical-center-modal" title="确认提示" :loading="setStatusloading" @on-ok="setEnableAsyncOK"><p>确认启用选中单位吗？</p></Modal>
		<Modal v-model="modalDisable" class-name="vertical-center-modal" title="确认提示" :loading="setStatusloading" @on-ok="setDisableAsyncOK"><p>确认禁用选中单位吗？</p></Modal>
	</Header>
	<Content class="list-content">
		<i-table :stripe="true" :columns="columns" :data="data"></i-table>
	    <div style="margin: 10px;overflow: hidden">
	        <div style="float: right;">
	            <Page :total="100" :current="1" :show-elevator="true" :show-sizer="true" @on-page-size-change="pageSize" @on-change="pageChange"></Page>
	        </div>
	    </div>		
	</Content>
</Layout>
{/block}

{block name="script"}
<script>
var columns = {$columns};
var actionList = {$actionList};

/* 这里加入对操作render的解析
 * 解析按钮、解析方式（跳转、ajax）、解析文字 
 */
columns.push({
    title: actionList.head,
    key: 'action',
    width: actionList.width,
    align: actionList.align,
    render: (h, params) => {
    	var renders = [];
    	for (var i = 0; i < actionList.actions.length; i++) {
    		renders.push(
                h('Button', {
                	props: eval('(' + actionList.actions[i].props + ')'),
                	style: eval('(' + actionList.actions[i].style + ')'),
                    on: {
                        click: () => {
                            console.log(params)
                        }
                    }
                }, actionList.actions[i].text)
    		);
    	}
    	
        return h('div', renders);
    }
});

ealingBuilder = {
	data: {
		setStatusloading: true,
		modalEnable: false,
		modalDisable: false,
		buttonList: {$buttonList},
		columns: columns,
		data: {$list}
	},
	methods: {
		setEnableAsyncOK () {
            setTimeout(() => {
                this.modalEnable = false;
            }, 2000);
		},
		setDisableAsyncOK () {
            setTimeout(() => {
                this.modalDisable = false;
            }, 2000);
		},
		pageSize () {
			console.log('调整每页显示行数');
		},
		pageChange () {
			this.data = [
				{id:3,status:'禁用',title:'onep2p'}
			];
		}
	}
};
</script>
{/block}